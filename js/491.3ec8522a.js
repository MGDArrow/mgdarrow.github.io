"use strict";(self["webpackChunkfunerals_ru"]=self["webpackChunkfunerals_ru"]||[]).push([[491],{27:function(e,l,n){n.d(l,{Z:function(){return r}});var t=n(3396);const a=["value"];function s(e,l,n,s,o,i){return(0,t.wg)(),(0,t.iD)("input",{type:"button",value:n.text},null,8,a)}var o={name:"TheButton",props:["text"]},i=n(89);const u=(0,i.Z)(o,[["render",s],["__scopeId","data-v-089df75f"]]);var r=u},3132:function(e,l,n){n.d(l,{Z:function(){return c}});var t=n(3396),a=n(7139);const s={class:"input-block"},o=["type","value"];function i(e,l,n,i,u,r){return(0,t.wg)(),(0,t.iD)("div",s,[(0,t._)("label",{class:(0,a.C_)({"input--is-focus":u.isFocus,"input--is-text":n.modelValue||0===n.modelValue,"input--is-valid":n.dirty&&!u.isFocus&&n.valid,"input--is-invalid":n.dirty&&!u.isFocus&&!n.valid})},[(0,t.Uk)((0,a.zw)(r.labelText)+" ",1),(0,t._)("input",{type:n.type,value:n.modelValue,onInput:l[0]||(l[0]=l=>e.$emit("update:modelValue",l.target.value)),onFocus:l[1]||(l[1]=e=>u.isFocus=!0),onBlur:l[2]||(l[2]=l=>{u.isFocus=!1,e.$emit("blur",!0)})},null,40,o)],2)])}var u={name:"TheInputText",props:["type","label","dirty","valid","labelInvalid","modelValue"],data(){return{isFocus:!1}},computed:{labelText(){return this.$props.labelInvalid&&!this.isFocus&&this.$props.dirty?`Заполните поле "${this.$props.label}"`:this.$props.label}}},r=n(89);const p=(0,r.Z)(u,[["render",i]]);var c=p},1491:function(e,l,n){n.r(l),n.d(l,{default:function(){return I}});var t=n(3396),a=n(7139);const s={class:"app__allocation"},o=(0,t._)("h1",null,"Распределение",-1);function i(e,l,n,i,u,r){const p=(0,t.up)("allocation-point");return(0,t.wg)(),(0,t.iD)("div",s,[o,((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(r.getFunerals,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{class:"allocation__data",key:e.id},[(0,t._)("h2",null,(0,a.zw)(l),1),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e,(e=>((0,t.wg)(),(0,t.j4)(p,{key:e.id,funeral:e},null,8,["funeral"])))),128))])))),128))])}n(7658);const u={class:"allocation__point"},r={class:"funeral__time"},p={class:"funeral__info"},c={key:0,class:"funeral-info__surname"},d={key:1,class:"funeral-info__templ"},m={class:"funeral__status"},f={key:0,class:"funeral__comment"};function _(e,l,n,s,o,i){const _=(0,t.up)("font-awesome-icon"),v=(0,t.up)("allocation-templ");return(0,t.wg)(),(0,t.iD)("div",u,[(0,t._)("div",{class:"read-funeral",onClick:l[0]||(l[0]=e=>o.isOpenEdit=!o.isOpenEdit)},[(0,t._)("div",r,(0,a.zw)(n.funeral.time),1),(0,t._)("div",p,[(0,t._)("div",{class:(0,a.C_)(["funeral-info__location",{"funeral-info__location--ws":!n.funeral.surname}])},(0,a.zw)(n.funeral.locationTempl||n.funeral.locationCemetery||n.funeral.locationAddress),3),n.funeral.surname?((0,t.wg)(),(0,t.iD)("div",c,(0,a.zw)(n.funeral.surname),1)):(0,t.kq)("",!0),n.funeral.locationTempl!==n.funeral.templ?((0,t.wg)(),(0,t.iD)("div",d,[(0,t._)("span",{class:(0,a.C_)({"funeral-red":"false"===n.funeral.templ})},(0,a.zw)(i.isTempl(n.funeral.templ)),3)])):(0,t.kq)("",!0)]),(0,t._)("div",m,[(0,t.Wm)(_,{icon:["fab","bitcoin"],class:(0,a.C_)({"funeral-red":!n.funeral.payment,"funeral-green":n.funeral.payment})},null,8,["class"]),null!==n.funeral.phoneLocation?((0,t.wg)(),(0,t.j4)(_,{key:0,icon:["fas","circle-check"],class:(0,a.C_)({"funeral-red":"false"===n.funeral.phoneLocation,"funeral-green":"true"==n.funeral.phoneLocation})},null,8,["class"])):(0,t.kq)("",!0),(0,t.Wm)(_,{icon:["fas","circle-check"],class:(0,a.C_)({"funeral-red":!n.funeral.phoneTempl,"funeral-green":n.funeral.phoneTempl})},null,8,["class"])]),n.funeral.comment?((0,t.wg)(),(0,t.iD)("div",f," *"+(0,a.zw)(n.funeral.comment),1)):(0,t.kq)("",!0)]),(0,t.Wm)(v,{open:o.isOpenEdit,templs:i.getTemplsSort,funeral:n.funeral},null,8,["open","templs","funeral"])])}const v={class:"add-templ__blanks"},h=["onClick"],T={class:"add-templ__blank--name"},w={class:"add-templ__blank--label"},b={class:"add-templ__blank--abbot"};function g(e,l,n,s,o,i){const u=(0,t.up)("the-input-text"),r=(0,t.up)("the-button");return(0,t.wg)(),(0,t.iD)("div",{class:(0,a.C_)(["allocation__templs",{"allocation__templs--open":n.open,"allocation__templs--open-max":i.getTempls}])},[(0,t.Wm)(u,{type:"text",label:"Выбрать храм",modelValue:o.inputTempl,"onUpdate:modelValue":l[0]||(l[0]=e=>o.inputTempl=e),modelModifiers:{trim:!0}},null,8,["modelValue"]),(0,t._)("div",v,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(i.getTempls,(e=>((0,t.wg)(),(0,t.iD)("div",{class:"add-templ__blank",key:e.id,onClick:l=>o.inputTempl=e.name},[(0,t._)("div",T,(0,a.zw)(e?.name),1),(0,t._)("div",w,(0,a.zw)(e?.label),1),(0,t._)("div",b,(0,a.zw)(e?.abbot),1)],8,h)))),128))]),(0,t.Wm)(r,{text:"Распределить",onClick:l[1]||(l[1]=e=>i.updateAllocation())})],2)}var k=n(27),C=n(3132),y={components:{TheInputText:C.Z,TheButton:k.Z},name:"AllocationTempl",props:["open","templs","funeral"],data(){return{inputTempl:""}},computed:{getTempls(){let e=this.$props.templs,l=this.inputTempl.toLowerCase();if(""===l||this.isTempl)return;let n=e.filter((e=>{let n=e.name.toLowerCase().includes(l),t=!!e.abbot&&e.abbot.toLowerCase().includes(l),a=!!e.label&&e.label.toLowerCase().includes(l);return n||t||a}));return n},isTempl(){let e=this.$props.templs;return e.find((e=>e.name.toLowerCase()===this.inputTempl.toLowerCase()))}},methods:{async updateAllocation(){this.isTempl&&this.$store.dispatch("EDIT_FUNERALS_ALLOCATION",[{templ:this.inputTempl},this.$props.funeral.id])}}},A=n(89);const L=(0,A.Z)(y,[["render",g]]);var D=L,$={components:{AllocationTempl:D},name:"ReadPoint",props:["funeral"],data(){return{isOpenEdit:!1}},computed:{getTemplsSort(){return this.$store.getters.GET_TEMPLS}},methods:{isTempl(e){return"false"===e?"Не распределено":e}}};const E=(0,A.Z)($,[["render",_]]);var F=E,x={name:"AppFunAllocation",components:{AllocationPoint:F},computed:{getFunerals(){let e=this.$store.getters.GET_FUNERALS_ALLOCATION;const l=e.reduce(((e,l)=>{if(this.$store.getters.GET_DATE_SUPABASE==l.date){const{locationTempl:n}=l,{locationCemetery:t}=l,{locationAddress:a}=l;n&&(e[n]=e[n]??[],e[n].push(l)),t&&(e[t]=e[t]??[],e[t].push(l)),a&&(e[a]=e[a]??[],e[a].push(l))}return e}),{});return l}}};const z=(0,A.Z)(x,[["render",i]]);var I=z}}]);
//# sourceMappingURL=491.3ec8522a.js.map