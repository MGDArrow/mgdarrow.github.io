import{u as j,D as M,M as S,a as c}from"./FuneralsStore-8aa12072.js";import{y as k,_ as v,q as m,o as d,c as i,v as s,z as y,t as _,A as p,a as r,n as C,F as b,r as D,B as g,T as $,C as T,D as A,E as x,G as B}from"./index-1510cbc2.js";import{T as N}from"./TheButton-dd162bf5.js";import{u as P}from"./CemeterysStore-46f8a078.js";import{u as z}from"./ServicesStore-0c4115a0.js";import{u as E}from"./TemplsStore-f8a64909.js";const I={name:"AppNavBar",computed:{...k(j,["getFuneralsForPhone","getFuneralsForPhoneAll","getFuneralsForAllocation","getFuneralsForAllocationAll","getFuneralsForRead"])}},U={class:"funerals-menu"},L={key:0,class:"point-check"},R={key:0,class:"point-check-all"},V={key:1,class:"point-check"},W={key:0,class:"point-check-all"},Y={key:1,class:"point-check"};function G(e,t,u,h,l,a){const o=m("font-awesome-icon"),n=m("router-link");return d(),i("nav",U,[s(n,{to:"/read",class:"funerals-menu__point"},{default:y(()=>[e.getFuneralsForRead.length?(d(),i("div",L,_(e.getFuneralsForRead.length),1)):p("",!0),s(o,{icon:["fas","list-ul"],size:"xs"})]),_:1}),s(n,{to:"/statistic",class:"funerals-menu__point"},{default:y(()=>[s(o,{icon:["fas","chart-simple"],size:"xs"})]),_:1}),s(n,{to:"/",class:"funerals-menu__point"},{default:y(()=>[s(o,{icon:["fas","plus"],size:"xs"})]),_:1}),s(n,{to:"/allocation",class:"funerals-menu__point"},{default:y(()=>[e.getFuneralsForAllocationAll.length?(d(),i("div",R,_(e.getFuneralsForAllocationAll.length),1)):p("",!0),e.getFuneralsForAllocation.length?(d(),i("div",V,_(e.getFuneralsForAllocation.length),1)):p("",!0),s(o,{icon:["fas","shuffle"],size:"xs"})]),_:1}),s(n,{to:"/phone",class:"funerals-menu__point"},{default:y(()=>[e.getFuneralsForPhoneAll.length?(d(),i("div",W,_(e.getFuneralsForPhoneAll.length),1)):p("",!0),e.getFuneralsForPhone.length?(d(),i("div",Y,_(e.getFuneralsForPhone.length),1)):p("",!0),s(o,{icon:["fas","phone"],size:"xs"})]),_:1}),s(n,{to:"/settings",class:"funerals-menu__point"},{default:y(()=>[s(o,{icon:["fas","gear"],size:"xs"})]),_:1})])}const q=v(I,[["render",G]]);const H={name:"AppDate",data(){return{openCalendar:!1,daysWeak:M,monthsFull:S,dateCalendarObj:void 0,calendarToday:void 0}},computed:{getDate(){return c().getDateShort},isShothToday(){let e=c().getUnCorrectDate;return new Date(e.year,e.month,e.day).getTime()==new Date(this.calendarToday.year,this.calendarToday.month,this.calendarToday.day).getTime()},isMonthNow(){return this.dateCalendarObj.year===this.calendarToday.year&&this.dateCalendarObj.month===this.calendarToday.month},getShortMonth(){let e=new Date(this.dateCalendarObj.year,this.dateCalendarObj.month),t=e.getFullYear(),u=e.getMonth();return`${this.monthsFull[u]} ${t}`},getDateCells(){let e=this.dateCalendarObj,t=(new Date(e.year,e.month+1,1)-new Date(e.year,e.month,1))/864e5,u=(new Date(e.year,e.month,1)-new Date(e.year,e.month-1,1))/864e5,h=new Date(e.year,e.month,1).getDay();h=h===0?6:--h;let l=[];for(let a=h;a>0;a--)l.push({day:u-a+1,isMonthStyle:"backMonth"});for(let a=1;a<=t;a++)l.push({day:a,isMonthStyle:"isMonth"});for(let a=1;a<=42-t-h;a++)l.push({day:a,isMonthStyle:"nextMonth"});return l}},methods:{setDateIncr(e){c().setDateIncrement(e),this.getMonthUpd()},setDateToday(){c().setDateToday(),this.getMonthUpd()},getMonthNow(){this.dateCalendarObj.year=this.calendarToday.year,this.dateCalendarObj.month=this.calendarToday.month},getMonthUpd(){let e=c().getUnCorrectDate;this.dateCalendarObj.year=new Date(e.year,e.month,e.day).getFullYear(),this.dateCalendarObj.month=new Date(e.year,e.month,e.day).getMonth()},isCellActive(e){let t=c().getUnCorrectDate;return new Date(t.year,t.month,t.day).getTime()==new Date(this.dateCalendarObj.year,this.dateCalendarObj.month,e).getTime()},isCellToday(e){return e.day==this.calendarToday.day&&this.dateCalendarObj.month==this.calendarToday.month&&this.dateCalendarObj.year==this.calendarToday.year&&e.isMonthStyle=="isMonth"||e.day==this.calendarToday.day&&this.dateCalendarObj.month-1==this.calendarToday.month&&this.dateCalendarObj.year==this.calendarToday.year&&e.isMonthStyle=="backMonth"||e.day==this.calendarToday.day&&this.dateCalendarObj.month+1==this.calendarToday.month&&this.dateCalendarObj.year==this.calendarToday.year&&e.isMonthStyle=="nextMonth"},clickSetCell(e){e.isMonthStyle=="backMonth"&&(this.dateCalendarObj.month=this.dateCalendarObj.month!=0?--this.dateCalendarObj.month:11,this.dateCalendarObj.year=this.dateCalendarObj.month==11?--this.dateCalendarObj.year:this.dateCalendarObj.year),e.isMonthStyle=="nextMonth"&&(this.dateCalendarObj.month=this.dateCalendarObj.month!=11?++this.dateCalendarObj.month:0,this.dateCalendarObj.year=this.dateCalendarObj.month==0?++this.dateCalendarObj.year:this.dateCalendarObj.year);let t={year:this.dateCalendarObj.year,month:this.dateCalendarObj.month,day:e.day};c().setDateByCalendarCell(t),this.openCalendar=!1}},created(){let e=new Date,t=e.getFullYear(),u=e.getMonth(),h=e.getDate();this.dateCalendarObj={year:t,month:u},this.calendarToday={year:t,month:u,day:h}}},J={class:"get-date"},K={class:"get-date__menu-date"},Q={class:"calendar__menu"},X={class:"calendar__weakdays"},Z={class:"calendar__days"},ee=["onClick"];function te(e,t,u,h,l,a){const o=m("font-awesome-icon");return d(),i("div",J,[r("div",K,[r("div",{class:C(["menu-date__text",{"js-menu-date__text--active":a.isShothToday}]),onClick:t[0]||(t[0]=n=>a.setDateToday())},_(a.getDate),3),r("div",{class:"menu-date__back--btn",onClick:t[1]||(t[1]=n=>a.setDateIncr(-1))},[s(o,{icon:["fas","caret-left"]})]),r("div",{class:"menu-date__next--btn",onClick:t[2]||(t[2]=n=>a.setDateIncr(1))},[s(o,{icon:["fas","caret-left"],rotation:"180"})]),r("div",{class:C(["menu-date__calendar--btn",{"js-calendar--btn--act":l.openCalendar}]),onClick:t[3]||(t[3]=n=>l.openCalendar=!l.openCalendar)},[s(o,{icon:["fas","calendar-days"]})],2)]),r("div",{class:C(["get-date__calendar",{"js-calendar--open":l.openCalendar}])},[r("div",Q,[r("div",{class:"menu__back--btn",onClick:t[4]||(t[4]=n=>--l.dateCalendarObj.month)},[s(o,{icon:["fas","caret-left"]})]),r("div",{class:C(["menu__text",{"js-menu__text--active":a.isMonthNow}]),onClick:t[5]||(t[5]=n=>a.getMonthNow())},_(a.getShortMonth),3),r("div",{class:"menu__next--btn",onClick:t[6]||(t[6]=n=>++l.dateCalendarObj.month)},[s(o,{icon:["fas","caret-left"],rotation:"180"})])]),r("div",X,[(d(!0),i(b,null,D(l.daysWeak,(n,f)=>(d(),i("div",{class:"weekdays__day",key:f},_(n),1))),128))]),r("div",Z,[(d(!0),i(b,null,D(a.getDateCells,n=>(d(),i("div",{class:C(["day",{"another-month":n.isMonthStyle=="backMonth"||n.isMonthStyle=="nextMonth","today-cell":a.isCellToday(n),"active-cell":a.isCellActive(n.day)&&n.isMonthStyle=="isMonth"}]),key:n.id,onClick:f=>a.clickSetCell(n)},_(n.day),11,ee))),128))])],2)])}const ae=v(H,[["render",te],["__scopeId","data-v-bc5226fc"]]);const ne={name:"AppPush",computed:{...k(g,["push"])}},se={class:"app-push"};function oe(e,t,u,h,l,a){return d(),i("div",se,[s($,{name:"push"},{default:y(()=>[(d(!0),i(b,null,D(this.push,o=>(d(),i("div",{key:o.id,class:C(["push__item",{basic:o.color=="basic",red:o.color=="red"}])},_(o.label),3))),128))]),_:1})])}const re=v(ne,[["render",oe]]);const le={components:{AppNavBar:q,AppDate:ae,TheButton:N,AppPush:re},name:"LayoutBasic",data(){return{getOnline:!1}},computed:{...k(g,["status","maildates"])},methods:{async updateData(){await P().getCemeterys(),await z().getServices(),await j().getFunerals(),await E().getTempls()}},async mounted(){this.updateData(),window.addEventListener("online",()=>this.getOnline=!0);let e=c().getDateForEmail;this.status&&(await g().getEmailDates(),this.maildates.find(t=>t.date===e)||(g().addPush("Отправка ежемесячного отчета","basic",1500),await g().postEmailDates(e),c().setDateByCalendarCell({year:c().getCorrectDate.year,month:c().getCorrectDate.month-1,day:c().getCorrectDate.day}),await this.updateData(),this.$router.push("/mail")))}},de={key:0,class:"get-update"},ie=r("div",{class:"get-update__back"},null,-1),ce={class:"get-update__block"},he=r("span",null,[T(" Подключение к интернету возобновлено! "),r("br"),T(" Необходимо синхронизировать данные! ")],-1),ue={class:"appBlockDate"},_e={class:"appBlockMain"},ye={class:"appBlockNav"};function me(e,t,u,h,l,a){const o=m("app-push"),n=m("the-button"),f=m("app-date"),O=m("router-view"),w=m("app-nav-bar");return d(),i("div",null,[s(o),l.getOnline&&this.status?(d(),i("div",de,[ie,r("div",ce,[he,s(n,{text:"Обновить",onClick:t[0]||(t[0]=F=>{l.getOnline=!1,a.updateData()})})])])):p("",!0),r("div",ue,[s(f)]),r("div",_e,[s(O,null,{default:y(({Component:F})=>[s(A,{name:"slide"},{default:y(()=>[(d(),x(B(F)))]),_:2},1024)]),_:1})]),r("div",ye,[s(w)])])}const De=v(le,[["render",me]]);export{De as default};
