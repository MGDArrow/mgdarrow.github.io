import{R as A}from"./ReadPoint-aaf78d93.js";import{T as k,a as x}from"./TheButton-2f782603.js";import{u as v}from"./FuneralsStore-9e9c8e9f.js";import{_ as T,q as u,o as i,c as r,v as m,a as c,F as h,r as b,t as d,n as C,A as y}from"./index-2e3796e7.js";import{u as $}from"./TemplsStore-df0ae72c.js";const F={components:{TheInputText:k,TheButton:x},name:"AllocationTempl",props:["open","templs","funeral"],data(){return{inputTempl:""}},computed:{getTempls(){let p=this.$props.templs,t=this.inputTempl.toLowerCase();return t===""||this.isTempl?void 0:p.filter(o=>{let l=o.name.toLowerCase().includes(t),s=o.abbot?o.abbot.toLowerCase().includes(t):!1,a=o.label?o.label.toLowerCase().includes(t):!1;return l||s||a})},isTempl(){return this.$props.templs.find(t=>t.name.toLowerCase()===this.inputTempl.toLowerCase())}},methods:{updateAllocation(){this.isTempl&&v().putFunerals({templ:this.inputTempl},this.$props.funeral.id)}}},L={class:"add-templ__blanks"},w=["onClick"],B={class:"add-templ__blank--name"},E={class:"add-templ__blank--label"},S={class:"add-templ__blank--abbot"};function V(p,t,n,o,l,s){const a=u("the-input-text"),_=u("the-button");return i(),r("div",{class:C(["allocation__templs",{"allocation__templs--open":n.open,"allocation__templs--open-max":s.getTempls}])},[m(a,{type:"text",label:"Выбрать храм",modelValue:l.inputTempl,"onUpdate:modelValue":t[0]||(t[0]=e=>l.inputTempl=e),modelModifiers:{trim:!0}},null,8,["modelValue"]),c("div",L,[(i(!0),r(h,null,b(s.getTempls,e=>(i(),r("div",{class:"add-templ__blank",key:e.id,onClick:f=>l.inputTempl=e.name},[c("div",B,d(e==null?void 0:e.name),1),c("div",E,d(e==null?void 0:e.label),1),c("div",S,d(e==null?void 0:e.abbot),1)],8,w))),128))]),m(_,{text:"Распределить",onClick:t[1]||(t[1]=e=>s.updateAllocation())})],2)}const g=T(F,[["render",V]]);const N={components:{AllocationTempl:g,ReadPoint:A},name:"AllocationPoint",props:["funeral"],data(){return{isOpenEdit:!1}},computed:{getTemplsSort(){return $().templs}}},O={class:"allocation__point"};function P(p,t,n,o,l,s){const a=u("read-point"),_=u("allocation-templ");return i(),r("div",O,[c("div",{class:"js-read-funeral",onClick:t[0]||(t[0]=e=>l.isOpenEdit=!l.isOpenEdit)},[m(a,{funeral:this.funeral},null,8,["funeral"])]),m(_,{open:l.isOpenEdit,templs:s.getTemplsSort,funeral:n.funeral},null,8,["open","templs","funeral"])])}const R=T(N,[["render",P]]);const j={name:"AppFunAllocation",components:{AllocationPoint:R},computed:{getFunerals(){return v().getFuneralsForAllocation.reduce((n,o)=>{const{locationTempl:l}=o,{locationCemetery:s}=o,{locationAddress:a}=o;return l&&(n[l]=n[l]??[],n[l].push(o)),s&&(n[s]=n[s]??[],n[s].push(o)),a&&(n[a]=n[a]??[],n[a].push(o)),n},{})}}},q={class:"app__allocation"},z=c("h1",null,"Распределение",-1);function D(p,t,n,o,l,s){const a=u("allocation-point");return i(),r("div",q,[z,(i(!0),r(h,null,b(s.getFunerals,(_,e)=>(i(),r("div",{class:"allocation__data",key:_.id},[c("h2",null,d(e),1),(i(!0),r(h,null,b(_,f=>(i(),y(a,{key:f.id,funeral:f},null,8,["funeral"]))),128))]))),128))])}const J=T(j,[["render",D]]);export{J as default};
