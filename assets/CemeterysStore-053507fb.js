import{S as d,B as r,s as a}from"./index-50c13f70.js";const c=d("CemeterysStore",{state(){return{cemeterys:[]}},actions:{async getCemeterys(){let e=i("CemeterysPostArray"),t=i("CemeterysDeleteArray");if(r().status)e&&await a.from("CEMETERY").insert(e).then(()=>{window.localStorage.removeItem("CemeterysPostArray"),r().addPush("Кладбища синхронизированны","basic",1500),this.getCemeterys()}),t&&await a.from("CEMETERY").delete().in("name",t).then(()=>{window.localStorage.removeItem("CemeterysDeleteArray"),r().addPush("Кладбища синхронизированны","basic",1500),this.getCemeterys()}),await a.from("CEMETERY").select("*").order("id",{ascending:!0}).then(s=>{this.cemeterys=s.data,o("CemeterysBigData",s.data)});else{let s=i("CemeterysBigData");e&&e.forEach(m=>{s.push(m)}),t&&t.forEach(m=>{let y=s.findIndex(n=>n.name===m);y!==-1&&s.splice(y,1)}),this.cemeterys=s}},async postCemeterys(e){if(r().status)await a.from("CEMETERY").insert(e).then(t=>{t.error?r().addPush("Не удалось добавить кладбище","red",3500):r().addPush("Кладбище добавлено","basic",1500)});else if(window.localStorage.getItem("CemeterysPostArray")){let t=i("CemeterysPostArray");t.push(e),o("CemeterysPostArray",t)}else o("CemeterysPostArray",[e]);window.navigator.vibrate([100,50,100]),this.getCemeterys()},async putCemeterys(e,t){await a.from("CEMETERY").update(e).eq("id",t).then(s=>{s.error?r().addPush("Не удалось изменить кладбище","red",3500):r().addPush("Кладбище изменено","basic",1500)}),this.getCemeterys(),window.navigator.vibrate(200)},async deleteCemeterys(e){if(r().status)await a.from("CEMETERY").delete().eq("id",e.id).then(t=>{t.error?r().addPush("Не удалось удалить кладбище","red",3500):r().addPush("Кладбище удалено","basic",1500)});else{if(window.localStorage.getItem("CemeterysDeleteArray")){let t=i("CemeterysDeleteArray");t.push(e.name),o("CemeterysDeleteArray",t)}else o("CemeterysDeleteArray",[e.name]);r().addPush("Кладбище удалено offline","basic",1500)}window.navigator.vibrate([500,100,50]),this.getCemeterys()}}});function i(e){return JSON.parse(window.localStorage.getItem(e))}function o(e,t){window.localStorage.setItem(e,JSON.stringify(t))}export{c as u};
