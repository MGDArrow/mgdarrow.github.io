import{u as g,D as M,M as S,a as l}from"./FuneralsStore-9f647dda.js";import{_ as b,q as u,o as i,c as h,v as s,y as _,t as m,z as v,a as o,n as p,F as T,r as j,A as k,B as f,C as O,T as x,D as B,E as F}from"./index-419911db.js";import{T as N}from"./TheButton-2a470ef6.js";import{u as L}from"./CemeterysStore-51890d66.js";import{u as $}from"./ServicesStore-bc4b7051.js";import{u as A}from"./TemplsStore-e9feb54f.js";const z={name:"AppNavBar",computed:{phoneLength(){return g().getFuneralsForPhone.length},allocationLength(){return g().getFuneralsForAllocation.length}}},E={class:"funerals-menu"},I={key:0,class:"point-check"},U={key:0,class:"point-check"};function V(e,t,y,c,d,a){const r=u("font-awesome-icon"),n=u("router-link");return i(),h("nav",E,[s(n,{to:"/read",class:"funerals-menu__point"},{default:_(()=>[s(r,{icon:["fas","list-ul"],size:"xs"})]),_:1}),s(n,{to:"/statistic",class:"funerals-menu__point"},{default:_(()=>[s(r,{icon:["fas","chart-simple"],size:"xs"})]),_:1}),s(n,{to:"/",class:"funerals-menu__point"},{default:_(()=>[s(r,{icon:["fas","plus"],size:"xs"})]),_:1}),s(n,{to:"/allocation",class:"funerals-menu__point"},{default:_(()=>[a.allocationLength?(i(),h("div",I,m(a.allocationLength),1)):v("",!0),s(r,{icon:["fas","shuffle"],size:"xs"})]),_:1}),s(n,{to:"/phone",class:"funerals-menu__point"},{default:_(()=>[a.phoneLength?(i(),h("div",U,m(a.phoneLength),1)):v("",!0),s(r,{icon:["fas","phone"],size:"xs"})]),_:1}),s(n,{to:"/settings",class:"funerals-menu__point"},{default:_(()=>[s(r,{icon:["fas","gear"],size:"xs"})]),_:1})])}const W=b(z,[["render",V]]);const Y={name:"AppDate",data(){return{openCalendar:!1,daysWeak:M,monthsFull:S,dateCalendarObj:void 0,calendarToday:void 0}},computed:{getDate(){return l().getDateShort},isShothToday(){let e=l().getUnCorrectDate;return new Date(e.year,e.month,e.day).getTime()==new Date(this.calendarToday.year,this.calendarToday.month,this.calendarToday.day).getTime()},isMonthNow(){return this.dateCalendarObj.year===this.calendarToday.year&&this.dateCalendarObj.month===this.calendarToday.month},getShortMonth(){let e=new Date(this.dateCalendarObj.year,this.dateCalendarObj.month),t=e.getFullYear(),y=e.getMonth();return`${this.monthsFull[y]} ${t}`},getDateCells(){let e=this.dateCalendarObj,t=(new Date(e.year,e.month+1,1)-new Date(e.year,e.month,1))/864e5,y=(new Date(e.year,e.month,1)-new Date(e.year,e.month-1,1))/864e5,c=new Date(e.year,e.month,1).getDay();c=c===0?6:--c;let d=[];for(let a=c;a>0;a--)d.push({day:y-a+1,isMonthStyle:"backMonth"});for(let a=1;a<=t;a++)d.push({day:a,isMonthStyle:"isMonth"});for(let a=1;a<=42-t-c;a++)d.push({day:a,isMonthStyle:"nextMonth"});return d}},methods:{setDateIncr(e){l().setDateIncrement(e),this.getMonthUpd()},setDateToday(){l().setDateToday(),this.getMonthUpd()},getMonthNow(){this.dateCalendarObj.year=this.calendarToday.year,this.dateCalendarObj.month=this.calendarToday.month},getMonthUpd(){let e=l().getUnCorrectDate;this.dateCalendarObj.year=new Date(e.year,e.month,e.day).getFullYear(),this.dateCalendarObj.month=new Date(e.year,e.month,e.day).getMonth()},isCellActive(e){let t=l().getUnCorrectDate;return new Date(t.year,t.month,t.day).getTime()==new Date(this.dateCalendarObj.year,this.dateCalendarObj.month,e).getTime()},isCellToday(e){return e.day==this.calendarToday.day&&this.dateCalendarObj.month==this.calendarToday.month&&this.dateCalendarObj.year==this.calendarToday.year&&e.isMonthStyle=="isMonth"||e.day==this.calendarToday.day&&this.dateCalendarObj.month-1==this.calendarToday.month&&this.dateCalendarObj.year==this.calendarToday.year&&e.isMonthStyle=="backMonth"||e.day==this.calendarToday.day&&this.dateCalendarObj.month+1==this.calendarToday.month&&this.dateCalendarObj.year==this.calendarToday.year&&e.isMonthStyle=="nextMonth"},clickSetCell(e){e.isMonthStyle=="backMonth"&&(this.dateCalendarObj.month=this.dateCalendarObj.month!=0?--this.dateCalendarObj.month:11,this.dateCalendarObj.year=this.dateCalendarObj.month==11?--this.dateCalendarObj.year:this.dateCalendarObj.year),e.isMonthStyle=="nextMonth"&&(this.dateCalendarObj.month=this.dateCalendarObj.month!=11?++this.dateCalendarObj.month:0,this.dateCalendarObj.year=this.dateCalendarObj.month==0?++this.dateCalendarObj.year:this.dateCalendarObj.year);let t={year:this.dateCalendarObj.year,month:this.dateCalendarObj.month,day:e.day};l().setDateByCalendarCell(t),this.openCalendar=!1}},created(){let e=new Date,t=e.getFullYear(),y=e.getMonth(),c=e.getDate();this.dateCalendarObj={year:t,month:y},this.calendarToday={year:t,month:y,day:c}}},q={class:"get-date"},P={class:"get-date__menu-date"},R={class:"calendar__menu"},G={class:"calendar__weakdays"},H={class:"calendar__days"},J=["onClick"];function K(e,t,y,c,d,a){const r=u("font-awesome-icon");return i(),h("div",q,[o("div",P,[o("div",{class:p(["menu-date__text",{"js-menu-date__text--active":a.isShothToday}]),onClick:t[0]||(t[0]=n=>a.setDateToday())},m(a.getDate),3),o("div",{class:"menu-date__back--btn",onClick:t[1]||(t[1]=n=>a.setDateIncr(-1))},[s(r,{icon:["fas","caret-left"]})]),o("div",{class:"menu-date__next--btn",onClick:t[2]||(t[2]=n=>a.setDateIncr(1))},[s(r,{icon:["fas","caret-left"],rotation:"180"})]),o("div",{class:p(["menu-date__calendar--btn",{"js-calendar--btn--act":d.openCalendar}]),onClick:t[3]||(t[3]=n=>d.openCalendar=!d.openCalendar)},[s(r,{icon:["fas","calendar-days"]})],2)]),o("div",{class:p(["get-date__calendar",{"js-calendar--open":d.openCalendar}])},[o("div",R,[o("div",{class:"menu__back--btn",onClick:t[4]||(t[4]=n=>--d.dateCalendarObj.month)},[s(r,{icon:["fas","caret-left"]})]),o("div",{class:p(["menu__text",{"js-menu__text--active":a.isMonthNow}]),onClick:t[5]||(t[5]=n=>a.getMonthNow())},m(a.getShortMonth),3),o("div",{class:"menu__next--btn",onClick:t[6]||(t[6]=n=>++d.dateCalendarObj.month)},[s(r,{icon:["fas","caret-left"],rotation:"180"})])]),o("div",G,[(i(!0),h(T,null,j(d.daysWeak,(n,C)=>(i(),h("div",{class:"weekdays__day",key:C},m(n),1))),128))]),o("div",H,[(i(!0),h(T,null,j(a.getDateCells,n=>(i(),h("div",{class:p(["day",{"another-month":n.isMonthStyle=="backMonth"||n.isMonthStyle=="nextMonth","today-cell":a.isCellToday(n),"active-cell":a.isCellActive(n.day)&&n.isMonthStyle=="isMonth"}]),key:n.id,onClick:C=>a.clickSetCell(n)},m(n.day),11,J))),128))])],2)])}const Q=b(Y,[["render",K],["__scopeId","data-v-c9824576"]]);const X={components:{AppNavBar:W,AppDate:Q,TheButton:N},name:"LayoutBasic",data(){return{getOnline:!1}},computed:{...k(f,["status"]),...k(f,["maildates"])},methods:{async updateData(){await L().getCemeterys(),await $().getServices(),await g().getFunerals(),await A().getTempls()}},async mounted(){this.updateData(),window.addEventListener("online",()=>this.getOnline=!0);let e=l().getDateForEmail;this.status&&(await f().getEmailDates(),this.maildates.find(t=>t.date===e)||(await f().postEmailDates(e),l().setDateByCalendarCell({year:l().getCorrectDate.year,month:l().getCorrectDate.month-1,day:l().getCorrectDate.day}),await this.updateData(),this.$router.push("/mail")))}},Z={key:0,class:"get-update"},ee=o("div",{class:"get-update__back"},null,-1),te={class:"get-update__block"},ae=o("span",null,[O(" Подключение к интернету возобновлено! "),o("br"),O(" Необходимо синхронизировать данные! ")],-1),ne={class:"appBlockDate"},se={class:"appBlockMain"},oe={class:"appBlockNav"};function de(e,t,y,c,d,a){const r=u("the-button"),n=u("app-date"),C=u("router-view"),w=u("app-nav-bar");return i(),h("div",null,[d.getOnline&&this.status?(i(),h("div",Z,[ee,o("div",te,[ae,s(r,{text:"Обновить",onClick:t[0]||(t[0]=D=>{d.getOnline=!1,a.updateData()})})])])):v("",!0),o("div",ne,[s(n)]),o("div",se,[s(C,null,{default:_(({Component:D})=>[s(x,{name:"slide"},{default:_(()=>[(i(),B(F(D)))]),_:2},1024)]),_:1})]),o("div",oe,[s(w)])])}const _e=b(X,[["render",de]]);export{_e as default};
