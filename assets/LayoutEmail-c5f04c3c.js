import{a as g,u as w}from"./FuneralsStore-d2234840.js";import{u as T}from"./TemplsStore-78ed7f72.js";import{u as F}from"./ServicesStore-c17a984f.js";import{_ as S,y as h,B as v,o as c,c as m,a as t,t as n,F as b,r as p,O as f}from"./index-4dbcca97.js";const u={_origin:"https://api.emailjs.com"},L=(s,e="https://api.emailjs.com")=>{u._userID=s,u._origin=e},x=(s,e,l)=>{if(!s)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!l)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class y{constructor(e){this.status=e?e.status:0,this.text=e?e.responseText:"Network Error"}}const k=(s,e,l={})=>new Promise((i,d)=>{const r=new XMLHttpRequest;r.addEventListener("load",({target:o})=>{const a=new y(o);a.status===200||a.text==="OK"?i(a):d(a)}),r.addEventListener("error",({target:o})=>{d(new y(o))}),r.open("POST",u._origin+s,!0),Object.keys(l).forEach(o=>{r.setRequestHeader(o,l[o])}),r.send(e)}),z=(s,e,l,i)=>{const d=i||u._userID;return x(d,s,e),k("/api/v1.0/email/send",JSON.stringify({lib_version:"3.11.0",user_id:d,service_id:s,template_id:e,template_params:l}),{"Content-type":"application/json"})},D=s=>{let e;if(typeof s=="string"?e=document.querySelector(s):e=s,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},O=(s,e,l,i)=>{const d=i||u._userID,r=D(l);x(d,s,e);const o=new FormData(r);return o.append("lib_version","3.11.0"),o.append("service_id",s),o.append("template_id",e),o.append("user_id",d),k("/api/v1.0/email/send-form",o)},_={init:L,send:z,sendForm:O};const q={name:"LayoutEmail",computed:{...h(g,["getDateForStatistic"]),...h(T,["templs"]),...h(w,["getFuneralsForStatistic"]),...h(F,["services"]),getTemplsDeaneryNic(){return this.templs.filter(e=>e.deanery=="Николаевский")},getTemplsDeaneryTheo(){return this.templs.filter(e=>e.deanery=="Богоявленский")},getLocationTempls(){return this.getFuneralsForStatistic.filter(l=>!!l.locationTempl&&l.locationTempl!=="Свято-Пантелеимоновский храм (ГБ №2)").length},getLocation2b(){return this.getFuneralsForStatistic.filter(l=>l.locationTempl==="Свято-Пантелеимоновский храм (ГБ №2)").length},getLocationCemeterys(){return this.getFuneralsForStatistic.filter(l=>!!l.locationCemetery).length},getLocationAddress(){return this.getFuneralsForStatistic.filter(l=>!!l.locationAddress).length}},methods:{getOdd(s){return s%2===0?"#e3e3e3":"white"},getFuneralsTempl(s){return this.getFuneralsForStatistic.filter(i=>i.templ===s&&!!i.payment).length},getServicesAll(s){return this.getFuneralsForStatistic.filter(i=>i.service==s).length}},mounted(){let s=this.$refs.email;s=new XMLSerializer().serializeToString(s),_.init("lUGqqOU7dq46rXtKd");var e={my_html:s};_.send("service_cholb4v","template_h4fywni",e),_.send("service_cholb4v","template_j0dt59d",e),this.$router.push("/statistic"),g().setDateToday(),v().addPush("Отчёт отправлен","basic",1500)}},E={class:"email-export",ref:"email",style:{"font-size":"14px"}},j={style:{width:"100%",margin:"5px auto","font-size":"1.8em"}},A={style:{width:"100%",margin:"5px auto",border:"2px solid black","border-collapse":"collapse"}},I=t("caption",{style:{background:"#c5e0b3","font-size":"1.5em","font-weight":"bold","text-align":"center"}}," Николаевский округ ",-1),M=t("tr",{style:{"font-size":"1.2em","border-bottom":"1px solid black"}},[t("th",{style:{width:"70%"}},"Храм"),t("th",{style:{width:"30%"}},"Всего")],-1),C={style:{background:"#fef2cb","text-align":"center","border-left":"1px solid black"}},N={style:{width:"100%",margin:"5px auto",border:"2px solid black","border-collapse":"collapse"}},P=t("caption",{style:{background:"#c5e0b3","font-size":"1.5em","font-weight":"bold","text-align":"center"}}," Богоявленский округ ",-1),H=t("tr",{style:{"font-size":"1.2em","border-bottom":"1px solid black"}},[t("th",{style:{width:"70%"}},"Храм"),t("th",{style:{width:"30%"}},"Всего")],-1),B={style:{background:"#fef2cb","text-align":"center","border-left":"1px solid black"}},V={style:{width:"100%",margin:"5px auto",border:"2px solid black","border-collapse":"collapse"}},U=t("caption",{style:{background:"#c5e0b3","font-size":"1.5em","font-weight":"bold","text-align":"center"}}," Ритуальные услуги ",-1),X=t("tr",{style:{"font-size":"1.2em","border-bottom":"1px solid black"}},[t("th",{style:{width:"70%"}},"Ритуальная"),t("th",{style:{width:"30%"}},"Всего")],-1),J={style:{background:"#fef2cb","text-align":"center","border-left":"1px solid black"}},K={style:{width:"100%",margin:"5px auto",border:"2px solid black","border-collapse":"collapse"}},G=t("caption",{style:{background:"#c5e0b3","font-size":"1.5em","font-weight":"bold","text-align":"center"}}," Местоположение ",-1),R={style:{"font-size":"1.1em","font-weight":"300","border-bottom":"1px solid black"}},Q=t("td",{style:{background:"#e3e3e3",width:"70%"}},"В храмах",-1),W={style:{background:"#fef2cb","text-align":"center","border-left":"1px solid black"}},Y={style:{"font-size":"1.1em","font-weight":"300","border-bottom":"1px solid black"}},Z=t("td",{style:{background:"white",width:"70%"}},"На ГБ №2",-1),$={style:{background:"#fef2cb","text-align":"center","border-left":"1px solid black"}},ee={style:{"font-size":"1.1em","font-weight":"300","border-bottom":"1px solid black"}},te=t("td",{style:{background:"#e3e3e3",width:"70%"}},"На кладбищах",-1),se={style:{background:"#fef2cb","text-align":"center","border-left":"1px solid black"}},oe={style:{"font-size":"1.1em","font-weight":"300","border-bottom":"1px solid black"}},re=t("td",{style:{background:"white",width:"70%"}},"По адресам",-1),le={style:{background:"#fef2cb","text-align":"center","border-left":"1px solid black"}};function ie(s,e,l,i,d,r){return c(),m("div",E,[t("h1",j," Отчет за "+n(this.getDateForStatistic),1),t("table",A,[I,M,(c(!0),m(b,null,p(r.getTemplsDeaneryNic,(o,a)=>(c(),m("tr",{style:{"font-size":"1.1em","font-weight":"300","border-bottom":"1px solid black"},key:o.id},[t("td",{style:f({background:r.getOdd(a)})},n(o.name),5),t("td",C,n(r.getFuneralsTempl(o.name)),1)]))),128))]),t("table",N,[P,H,(c(!0),m(b,null,p(r.getTemplsDeaneryTheo,(o,a)=>(c(),m("tr",{style:{"font-size":"1.1em","font-weight":"300","border-bottom":"1px solid black"},key:o.id},[t("td",{style:f({background:r.getOdd(a)})},n(o.name),5),t("td",B,n(r.getFuneralsTempl(o.name)),1)]))),128))]),t("table",V,[U,X,(c(!0),m(b,null,p(this.services,(o,a)=>(c(),m("tr",{style:{"font-size":"1.1em","font-weight":"300","border-bottom":"1px solid black"},key:o.id},[t("td",{style:f({background:r.getOdd(a)})},n(o.name),5),t("td",J,n(r.getServicesAll(o.name)),1)]))),128))]),t("table",K,[G,t("tr",R,[Q,t("td",W,n(r.getLocationTempls),1)]),t("tr",Y,[Z,t("td",$,n(r.getLocation2b),1)]),t("tr",ee,[te,t("td",se,n(r.getLocationCemeterys),1)]),t("tr",oe,[re,t("td",le,n(r.getLocationAddress),1)])])],512)}const me=S(q,[["render",ie]]);export{me as default};
