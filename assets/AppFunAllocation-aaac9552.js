import{T as y,a as L}from"./TheButton-b7f95ef0.js";import{_ as A,q as p,o as i,c as r,v as f,a as c,F as v,r as b,t as u,n as m,z as h,A as k}from"./index-6e9615e3.js";const C={components:{TheInputText:y,TheButton:L},name:"AllocationTempl",props:["open","templs","funeral"],data(){return{inputTempl:""}},computed:{getTempls(){let _=this.$props.templs,n=this.inputTempl.toLowerCase();return n===""||this.isTempl?void 0:_.filter(l=>{let s=l.name.toLowerCase().includes(n),a=l.abbot?l.abbot.toLowerCase().includes(n):!1,o=l.label?l.label.toLowerCase().includes(n):!1;return s||a||o})},isTempl(){return this.$props.templs.find(n=>n.name.toLowerCase()===this.inputTempl.toLowerCase())}},methods:{async updateAllocation(){this.isTempl&&this.$store.dispatch("EDIT_FUNERALS_ALLOCATION",[{templ:this.inputTempl},this.$props.funeral.id])}}},x={class:"add-templ__blanks"},E=["onClick"],w={class:"add-templ__blank--name"},g={class:"add-templ__blank--label"},F={class:"add-templ__blank--abbot"};function N(_,n,e,l,s,a){const o=p("the-input-text"),d=p("the-button");return i(),r("div",{class:m(["allocation__templs",{"allocation__templs--open":e.open,"allocation__templs--open-max":a.getTempls}])},[f(o,{type:"text",label:"Выбрать храм",modelValue:s.inputTempl,"onUpdate:modelValue":n[0]||(n[0]=t=>s.inputTempl=t),modelModifiers:{trim:!0}},null,8,["modelValue"]),c("div",x,[(i(!0),r(v,null,b(a.getTempls,t=>(i(),r("div",{class:"add-templ__blank",key:t.id,onClick:T=>s.inputTempl=t.name},[c("div",w,u(t==null?void 0:t.name),1),c("div",g,u(t==null?void 0:t.label),1),c("div",F,u(t==null?void 0:t.abbot),1)],8,E))),128))]),f(d,{text:"Распределить",onClick:n[1]||(n[1]=t=>a.updateAllocation())})],2)}const O=A(C,[["render",N]]);const S={components:{AllocationTempl:O},name:"ReadPoint",props:["funeral"],data(){return{isOpenEdit:!1}},computed:{getTemplsSort(){return this.$store.getters.GET_TEMPLS}},methods:{isTempl(_){return _==="false"?"Не распределено":_}}},B={class:"allocation__point"},V={class:"funeral__time"},P={class:"funeral__info"},I={key:0,class:"funeral-info__surname"},U={key:1,class:"funeral-info__templ"},D={class:"funeral__status"},G={key:0,class:"funeral__comment"};function R(_,n,e,l,s,a){const o=p("font-awesome-icon"),d=p("allocation-templ");return i(),r("div",B,[c("div",{class:"read-funeral",onClick:n[0]||(n[0]=t=>s.isOpenEdit=!s.isOpenEdit)},[c("div",V,u(e.funeral.time),1),c("div",P,[c("div",{class:m(["funeral-info__location",{"funeral-info__location--ws":!e.funeral.surname}])},u(e.funeral.locationTempl||e.funeral.locationCemetery||e.funeral.locationAddress),3),e.funeral.surname?(i(),r("div",I,u(e.funeral.surname),1)):h("",!0),e.funeral.locationTempl!==e.funeral.templ?(i(),r("div",U,[c("span",{class:m({"funeral-red":e.funeral.templ==="false"})},u(a.isTempl(e.funeral.templ)),3)])):h("",!0)]),c("div",D,[f(o,{icon:["fab","bitcoin"],class:m({"funeral-red":!e.funeral.payment,"funeral-green":e.funeral.payment})},null,8,["class"]),e.funeral.phoneLocation!==null?(i(),k(o,{key:0,icon:["fas","circle-check"],class:m({"funeral-red":e.funeral.phoneLocation==="false","funeral-green":e.funeral.phoneLocation=="true"})},null,8,["class"])):h("",!0),f(o,{icon:["fas","circle-check"],class:m({"funeral-red":!e.funeral.phoneTempl,"funeral-green":e.funeral.phoneTempl})},null,8,["class"])]),e.funeral.comment?(i(),r("div",G," *"+u(e.funeral.comment),1)):h("",!0)]),f(d,{open:s.isOpenEdit,templs:a.getTemplsSort,funeral:e.funeral},null,8,["open","templs","funeral"])])}const z=A(S,[["render",R]]);const M={name:"AppFunAllocation",components:{AllocationPoint:z},computed:{getFunerals(){return this.$store.getters.GET_FUNERALS_ALLOCATION.reduce((e,l)=>{if(this.$store.getters.GET_DATE_SUPABASE==l.date){const{locationTempl:s}=l,{locationCemetery:a}=l,{locationAddress:o}=l;s&&(e[s]=e[s]??[],e[s].push(l)),a&&(e[a]=e[a]??[],e[a].push(l)),o&&(e[o]=e[o]??[],e[o].push(l))}return e},{})}}},q={class:"app__allocation"},j=c("h1",null,"Распределение",-1);function H(_,n,e,l,s,a){const o=p("allocation-point");return i(),r("div",q,[j,(i(!0),r(v,null,b(a.getFunerals,(d,t)=>(i(),r("div",{class:"allocation__data",key:d.id},[c("h2",null,u(t),1),(i(!0),r(v,null,b(d,T=>(i(),k(o,{key:T.id,funeral:T},null,8,["funeral"]))),128))]))),128))])}const Q=A(M,[["render",H]]);export{Q as default};
