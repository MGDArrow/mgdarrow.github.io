import{S as d,B as s,s as r}from"./index-54c2cc17.js";const T=d("TemplsStore",{state(){return{templs:[]}},actions:{async getTempls(){let e=l("TemplsPostArray"),t=l("TemplsDeleteArray");if(s().status)e&&await r.from("TEMPL").insert(e).then(()=>{window.localStorage.removeItem("TemplsPostArray"),s().addPush("Храмы синхронизированны","basic",1500),this.getTempls()}),t&&await r.from("TEMPL").delete().in("name",t).then(()=>{window.localStorage.removeItem("TemplsDeleteArray"),s().addPush("Храмы синхронизированны","basic",1500),this.getTempls()}),await r.from("TEMPL").select("*").order("id",{ascending:!0}).then(a=>{this.templs=a.data,i("TemplsBigData",a.data)});else{let a=l("TemplsBigData");e&&e.forEach(o=>{a.push(o)}),t&&t.forEach(o=>{let m=a.findIndex(n=>n.name===o);m!==-1&&a.splice(m,1)}),this.templs=a}},async postTempls(e){if(s().status)await r.from("TEMPL").insert(e).then(t=>{t.error?s().addPush("Не удалось добавить храм","red",3500):s().addPush("Храм добавлен","basic",1500)});else if(window.localStorage.getItem("TemplsPostArray")){let t=l("TemplsPostArray");t.push(e),i("TemplsPostArray",t)}else i("TemplsPostArray",[e]);window.navigator.vibrate([100,50,100]),this.getTempls()},async putTempls(e,t){await r.from("TEMPL").update(e).eq("id",t).then(a=>{a.error?s().addPush("Не удалось удалить храм","red",3500):s().addPush("Храм изменён","basic",1500)}),window.navigator.vibrate(200),this.getTempls()},async deleteTempls(e){if(s().status)await r.from("TEMPL").delete().eq("id",e.id).then(t=>{t.error?s().addPush("Не удалось удалить храм","red",3500):s().addPush("Храм удалён","basic",1500)});else{if(window.localStorage.getItem("TemplsDeleteArray")){let t=l("TemplsDeleteArray");t.push(e.name),i("TemplsDeleteArray",t)}else i("TemplsDeleteArray",[e.name]);s().addPush("Храм удалён offline","basic",1500)}window.navigator.vibrate([500,100,50]),this.getTempls()}}});function l(e){return JSON.parse(window.localStorage.getItem(e))}function i(e,t){window.localStorage.setItem(e,JSON.stringify(t))}export{T as u};
