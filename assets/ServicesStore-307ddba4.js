import{S as d,B as r,s as i}from"./index-689b978f.js";const v=d("ServicesStore",{state(){return{services:[]}},actions:{async getServices(){let e=a("ServicesPostArray"),s=a("ServicesDeleteArray");if(r().status)e&&await i.from("SERVICE").insert(e).then(()=>{window.localStorage.removeItem("ServicesPostArray"),r().addPush("Ритуалки синхронизированны","basic",1500),this.getServices()}),s&&await i.from("SERVICE").delete().in("name",s).then(()=>{window.localStorage.removeItem("ServicesDeleteArray"),r().addPush("Ритуалки синхронизированны","basic",1500),this.getServices()}),await i.from("SERVICE").select("*").order("id",{ascending:!0}).then(t=>{this.services=t.data,c("ServicesBigData",t.data)});else{let t=a("ServicesBigData");e&&e.forEach(o=>{t.push(o)}),s&&s.forEach(o=>{let n=t.findIndex(S=>S.name===o);console.log(n),n!==-1&&t.splice(n,1)}),this.services=t}},async postServices(e){if(r().status)await i.from("SERVICE").insert(e).then(s=>{s.error?r().addPush("Не удалось добавить ритуалку","red",3500):r().addPush("Ритуалка добавлена","basic",1500)});else if(window.localStorage.getItem("ServicesPostArray")){let s=a("ServicesPostArray");s.push(e),c("ServicesPostArray",s)}else c("ServicesPostArray",[e]);window.navigator.vibrate([100,50,100]),this.getServices()},async putServices(e,s){await i.from("SERVICE").update(e).eq("id",s).then(t=>{t.error?r().addPush("Не удалось изменить ритуалку","red",3500):r().addPush("Ритуалка изменена","basic",1500)}),window.navigator.vibrate(200),this.getServices()},async deleteServices(e){if(r().status)await i.from("SERVICE").delete().eq("id",e.id).then(s=>{s.error?r().addPush("Не удалось удалить ритуалку","red",3500):r().addPush("Ритуалка удалена","basic",1500)});else{if(window.localStorage.getItem("ServicesDeleteArray")){let s=a("ServicesDeleteArray");s.push(e.name),c("ServicesDeleteArray",s)}else c("ServicesDeleteArray",[e.name]);r().addPush("Ритуалка удалена offline","basic",1500)}window.navigator.vibrate([500,100,50]),this.getServices()}}});function a(e){return JSON.parse(window.localStorage.getItem(e))}function c(e,s){window.localStorage.setItem(e,JSON.stringify(s))}export{v as u};
